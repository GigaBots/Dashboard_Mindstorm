define("PewRuntime",["require","exports"],function(e,t){function r(e){return e.length+":"+e+","}function i(e){var t=e.indexOf(":"),n=e.substr(t+1);return n.substr(0,n.length-1)}function s(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",n,r,i,s,o,u,a,f,l=0,c=0,h="",p=[];if(!e)return e;do n=e.charCodeAt(l++),r=e.charCodeAt(l++),i=e.charCodeAt(l++),f=n<<16|r<<8|i,s=f>>18&63,o=f>>12&63,u=f>>6&63,a=f&63,p[c++]=t.charAt(s)+t.charAt(o)+t.charAt(u)+t.charAt(a);while(l<e.length);h=p.join("");var d=e.length%3;return(d?h.slice(0,d-3):h)+"===".slice(d||3)}function o(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",n,r,i,s,o,u,a,f,l=0,c=0,h="",p=[];if(!e)return e;e+="";do s=t.indexOf(e.charAt(l++)),o=t.indexOf(e.charAt(l++)),u=t.indexOf(e.charAt(l++)),a=t.indexOf(e.charAt(l++)),f=s<<18|o<<12|u<<6|a,n=f>>16&255,r=f>>8&255,i=f&255,u==64?p[c++]=String.fromCharCode(n):a==64?p[c++]=String.fromCharCode(n,r):p[c++]=String.fromCharCode(n,r,i);while(l<e.length);return h=p.join(""),h}function l(e){var t,n,r,i,s,o,a,f,l=0,c=0,h="",p=[];if(!e)return e;do i=u[e.charAt(l++)],s=u[e.charAt(l++)],o=u[e.charAt(l++)],a=u[e.charAt(l++)],f=i<<18|s<<12|o<<6|a,t=f>>16&255,n=f>>8&255,r=f&255,o==64?p[c++]=String.fromCharCode(t):a==64?p[c++]=String.fromCharCode(t,n):p[c++]=String.fromCharCode(t,n,r);while(l<e.length);return h=p.join(""),h}function c(e){return t.base64_decode_fast(e)}var n=function(){function e(e){this.base64string=e}return e.prototype.getBytesAsBase64=function(){return this.base64string},e.prototype.getBytesAsUTF8=function(){return t.base64_decode(this.base64string)},e.prototype.getBytesAsJSON=function(){return JSON.parse(this.getBytesAsUTF8())},e.prototype.toJSON=function(){return this.base64string},e}();t.ByteArray=n,t.encodeNetstring=r,t.decodeNetstring=i,t.base64_encode=s,t.base64_decode_slow=o;var u={},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";for(var f=0;f<a.length;f++)u[a.charAt(f)]=f;t.base64_decode_fast=l,t.base64_decode=c}),define("WireProtocol.Protocol",["require","exports","./PewRuntime"],function(e,t,n){var r=function(){function e(){this.protocolId=0,this.protocolHash="6d57e4b8c8746db1711874a131731111"}return e.prototype.wrapNetstring=function(e){var t=e.messageType+":"+e.serializeJson();return n.encodeNetstring(t)},e.prototype.dispatchNetstring=function(e){var t=e.indexOf(":"),n=e.substr(t+1),r=parseInt(e.substr(0,t));switch(r){case 0:var E=new i;E.deserializeJson(n),this.listener.onWireChannelDataCreate(E);break;case 1:var S=new s;S.deserializeJson(n),this.listener.onWireChannelDataDel(S);break;case 2:var x=new o;x.deserializeJson(n),this.listener.onWireChannelDataDelete(x);break;case 3:var T=new u;T.deserializeJson(n),this.listener.onWireChannelDataPut(T);break;case 4:var N=new a;N.deserializeJson(n),this.listener.onWireChannelDataUpdate(N);break;case 5:var C=new f;C.deserializeJson(n),this.listener.onWireChannelJoin(C);break;case 6:var k=new l;k.deserializeJson(n),this.listener.onWireChannelLeave(k);break;case 7:var L=new c;L.deserializeJson(n),this.listener.onWireChannelMessage(L);break;case 8:var A=new h;A.deserializeJson(n),this.listener.onWireChannelSubscribe(A);break;case 9:var O=new p;O.deserializeJson(n),this.listener.onWireChannelUnSubscribe(O);break;case 10:var M=new d;M.deserializeJson(n),this.listener.onWireConnectFailure(M);break;case 11:var _=new v;_.deserializeJson(n),this.listener.onWireConnectRequest(_);break;case 12:var D=new m;D.deserializeJson(n),this.listener.onWireConnectSuccess(D);break;case 13:var P=new g;P.deserializeJson(n),this.listener.onWireDisconnectRequest(P);break;case 14:var H=new y;H.deserializeJson(n),this.listener.onWireDisconnectSuccess(H);break;case 15:var B=new b;B.deserializeJson(n),this.listener.onWireQueueMessage(B);break;case 16:var j=new w;j.deserializeJson(n),this.listener.onWireRpcMessage(j)}},e}();t.WireProtocol=r;var i=function(){function e(){this.messageType=0}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.key=t.key,this.ks=t.ks,this.name=t.name,this.payload=new n.ByteArray(t.payload)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.key_IS_SET=1,e.ks_IS_SET=2,e.name_IS_SET=4,e.payload_IS_SET=8,e}();t.WireChannelDataCreate=i;var s=function(){function e(){this.messageType=1}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.key=t.key,this.ks=t.ks,this.name=t.name},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.key_IS_SET=1,e.ks_IS_SET=2,e.name_IS_SET=4,e}();t.WireChannelDataDel=s;var o=function(){function e(){this.messageType=2}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.key=t.key,this.ks=t.ks,this.name=t.name,this.payload=new n.ByteArray(t.payload)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.key_IS_SET=1,e.ks_IS_SET=2,e.name_IS_SET=4,e.payload_IS_SET=8,e}();t.WireChannelDataDelete=o;var u=function(){function e(){this.messageType=3}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.key=t.key,this.ks=t.ks,this.name=t.name,this.payload=new n.ByteArray(t.payload)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.key_IS_SET=1,e.ks_IS_SET=2,e.name_IS_SET=4,e.payload_IS_SET=8,e}();t.WireChannelDataPut=u;var a=function(){function e(){this.messageType=4}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.key=t.key,this.ks=t.ks,this.name=t.name,this.payload=new n.ByteArray(t.payload)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.key_IS_SET=1,e.ks_IS_SET=2,e.name_IS_SET=4,e.payload_IS_SET=8,e}();t.WireChannelDataUpdate=a;var f=function(){function e(){this.messageType=5}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.name=t.name,this.success=t.success,this.channelPermissions=t.channelPermissions,this.errorMessage=t.errorMessage},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.name_IS_SET=1,e.success_IS_SET=2,e.channelPermissions_IS_SET=4,e.errorMessage_IS_SET=8,e}();t.WireChannelJoin=f;var l=function(){function e(){this.messageType=6}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.name=t.name},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.name_IS_SET=1,e}();t.WireChannelLeave=l;var c=function(){function e(){this.messageType=7}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.senderId=t.senderId,this.name=t.name,this.payload=new n.ByteArray(t.payload)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.senderId_IS_SET=1,e.name_IS_SET=2,e.payload_IS_SET=4,e}();t.WireChannelMessage=c;var h=function(){function e(){this.messageType=8}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.name=t.name,this.jsonConfig=t.jsonConfig},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.name_IS_SET=1,e.jsonConfig_IS_SET=2,e}();t.WireChannelSubscribe=h;var p=function(){function e(){this.messageType=9}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.name=t.name},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.name_IS_SET=1,e}();t.WireChannelUnSubscribe=p;var d=function(){function e(){this.messageType=10}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.failureMessage=t.failureMessage},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.failureMessage_IS_SET=1,e}();t.WireConnectFailure=d;var v=function(){function e(){this.messageType=11}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.version=t.version,this.clientKey=t.clientKey},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.version_IS_SET=1,e.clientKey_IS_SET=2,e}();t.WireConnectRequest=v;var m=function(){function e(){this.messageType=12}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.clientId=t.clientId},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.clientId_IS_SET=1,e}();t.WireConnectSuccess=m;var g=function(){function e(){this.messageType=13}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e}();t.WireDisconnectRequest=g;var y=function(){function e(){this.messageType=14}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e}();t.WireDisconnectSuccess=y;var b=function(){function e(){this.messageType=15}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.id=t.id,this.name=t.name,this.payload=new n.ByteArray(t.payload)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.id_IS_SET=1,e.name_IS_SET=2,e.payload_IS_SET=4,e}();t.WireQueueMessage=b;var w=function(){function e(){this.messageType=16}return e.prototype.serializeJson=function(){return JSON.stringify(this)},e.prototype.deserializeJson=function(e){var t=JSON.parse(e);this.id=t.id,this.ns=t.ns,this.payload=new n.ByteArray(t.payload)},e.prototype.setPewBitmask=function(e){this._pew_bitmask_|=e},e.prototype.unsetPewBitmask=function(e){this._pew_bitmask_&=e},e.prototype.pewBitmaskIsSetFor=function(e){return(this._pew_bitmask_&e)==e},e.id_IS_SET=1,e.ns_IS_SET=2,e.payload_IS_SET=4,e}();t.WireRpcMessage=w}),define("BigBangClient",["require","exports","./PewRuntime","./WireProtocol.Protocol"],function(e,t,n,r){(function(e){var t=function(){function e(){}return e}();e.LoginResult=t;var s=function(){function e(){}return e}(),o=function(){function e(e){this.message=e}return e.prototype.toString=function(){return this.message},e}();e.ChannelError=o;var u=function(){function e(){}return e}();e.ChannelMessage=u;var a=function(){function e(){}return e}();e.ConnectionResult=a;var f=function(){function e(e){this.client=e,this.responses={},this.keySpaces={},this.channelPermissions=[],this.currentSubscribers=[],this.keySpaces._meta=new l(e,"_meta",this),this.keySpaces.def=new l(e,"def",this),this.channelData=this.keySpaces.def}return e.prototype.subscribers=function(){var e=[],t=this.metaKeyspace().get("subs");if(t){var n=t.subs;n.forEach(function(t){e.push(t)})}return e},e.prototype.onMessage=function(e){this.onMessageHandler=e},e.prototype.onSubscribers=function(e,t){var n=this;this.metaKeyspace().on("subs",function(r){var i=n.currentSubscribers;n.currentSubscribers=n.subscribers();var s=n.diff(i,n.subscribers());s.forEach(function(n){i.indexOf(n)!=-1?t(n):e(n)})},null)},e.prototype.diff=function(e,t){var n=[],r=[];for(var i=0;i<e.length;i++)n[e[i]]=!0;for(var i=0;i<t.length;i++)n[t[i]]?delete n[t[i]]:n[t[i]]=!0;for(var s in n)r.push(s);return r},e.prototype.listChanged=function(e,t){var n=[];return e.forEach(function(e){-1===t.indexOf(e)&&n.push(e)},this),n},e.prototype.getKeyspace=function(e){return this.getOrCreateChannelData(e)},e.prototype.setChannelPermissions=function(e){this.channelPermissions=e},e.prototype.metaKeyspace=function(){return this.keySpaces._meta},e.prototype.publish=function(e,t){if(this.hasPermission("Publish")){this.publishByteArray(new n.ByteArray(n.base64_encode(JSON.stringify(e))));if(t){var r=null;t(r)}}else t&&t(new o("No permission to publish on channel."))},e.prototype.publishByteArray=function(e){var t=new r.WireChannelMessage;t.name=this.name,t.payload=e,this.client.sendToServer(t)},e.prototype.send=function(e,t){var i=new r.WireQueueMessage;i.id=null,i.name=this.name,i.payload=new n.ByteArray(n.base64_encode(JSON.stringify(e)));if(t){i.id=this.randomRequestId();var o=new s;o.type="json",o.callback=t,this.responses[i.id]=o}this.client.sendToServer(i)},e.prototype.hasPermission=function(e){var t=!1;return this.channelPermissions.forEach(function(n){e==n&&(t=!0)}),t},e.prototype.onWireChannelMessage=function(e){if(this.onMessageHandler){var t=new i.ChannelMessage;t.channel=this,t.payload=e.payload,t.senderId=e.senderId,this.onMessageHandler(t)}},e.prototype.onWireQueueMessage=function(e){if(e.id){var t=this.responses[e.id];t&&(delete this.responses[e.id],t.type=="json"?t.callback(JSON.parse(n.base64_decode(e.payload.getBytesAsBase64()))):t.type!="bytes"&&t.type!="string"&&console.error("Failed wire queue message."))}else console.error("Error mapping response id "+e.id)},e.prototype.getOrCreateChannelData=function(e){var t;return!e||"def"==e?t=this.keySpaces.def:t=this.keySpaces[e],t||(t=new l(this.client,e,this),this.keySpaces[e]=t),t},e.prototype.onWireChannelDataCreate=function(e){this.getOrCreateChannelData(e.ks).onWireChannelDataCreate(e)},e.prototype.onWireChannelDataUpdate=function(e){this.getOrCreateChannelData(e.ks).onWireChannelDataUpdate(e)},e.prototype.onWireChannelDataDelete=function(e){this.getOrCreateChannelData(e.ks).onWireChannelDataDelete(e)},e.prototype.randomRequestId=function(){return Math.floor(Math.random()*999999+1).toString()},e}();e.Channel=f;var l=function(){function e(e,t,n){this.client=e,this.keySpace=t,this.elementMap={},this.updateMap={},this.deleteMap={},this.addListeners=[],this.updateListeners=[],this.delListeners=[],this.channel=n}return e.prototype.get=function(e){return this.elementMap[e]},e.prototype.keys=function(){var e=[];for(var t in this.elementMap)e.push(t);return e},e.prototype.put=function(e,t,i){if(!e){i(new o("ChannelData key cannot be null."));return}if(!t){i(new o("ChannelData value cannot be null."));return}if(this.channel.hasPermission("PutChannelData")){var s=new r.WireChannelDataPut;s.key=e,s.ks=this.keySpace,s.name=this.channel.name,s.payload=new n.ByteArray(n.base64_encode(JSON.stringify(t))),this.client.sendToServer(s),i&&i(null)}else i&&i(new o("No permission to put on this channel."))},e.prototype.del=function(e,t){if(!e){t(new o("ChannelData key cannot be null."));return}if(this.channel.hasPermission("DelChannelData")){var n=new r.WireChannelDataDel;n.key=e,n.ks=this.keySpace,n.name=this.channel.name,this.client.sendToServer(n),t&&t(null)}else t&&t(new o("No permission to del on this channel."))},e.prototype.on=function(e,t,n){t&&(this.updateMap[e]=t),n&&(this.deleteMap[e]=n)},e.prototype.onValue=function(e,t,n){e&&this.addListeners.push(e),t&&this.updateListeners.push(t),n&&this.delListeners.push(n)},e.prototype.onWireChannelDataCreate=function(e){var t=e.payload.getBytesAsUTF8(),n=JSON.parse(t);this.elementMap[e.key]=n;var r=this.updateMap[e.key];r&&r(n),this.addListeners.forEach(function(t){t(e.key,n)})},e.prototype.onWireChannelDataUpdate=function(e){var t=e.payload.getBytesAsUTF8(),n=JSON.parse(t);this.elementMap[e.key]=n;var r=this.updateMap[e.key];r&&r(n),this.updateListeners.forEach(function(t){t(e.key,n)})},e.prototype.onWireChannelDataDelete=function(e){delete this.elementMap[e.key];var t=this.deleteMap[e.key];t&&t(),delete this.deleteMap[e.key],this.delListeners.forEach(function(t){t(e.key)})},e}();e.ChannelData=l;var c=function(){function e(){this.bufString="",this.channelListeners={},this.wireProtocol=new r.WireProtocol,this.wireProtocol.listener=this,this.connect=this.connect.bind(this),this.onConnect=this.onConnect.bind(this),this.subscribe=this.subscribe.bind(this),this.channelSubscribeMap={},this.channelMap={}}return e.prototype.connect=function(e,t,n,r){throw new Error("abstract")},e.prototype.connectAnonymous=function(e,t){throw new Error("abstract")},e.prototype.sendToServer=function(e){throw new Error("abstract")},e.prototype.subscribe=function(e,t){this.channelSubscribeMap[e]=t;var n=new r.WireChannelSubscribe;n.name=e,this.sendToServer(n)},e.prototype.unsubscribe=function(e){throw new Error("Not implemented")},e.prototype.getChannel=function(e){return this.channelMap[e]},e.prototype.onConnect=function(){var e=new r.WireConnectRequest;e.clientKey=this._clientKey,e.version=1234,this.sendToServer(e)},e.prototype.onDisconnect=function(e){throw new Error("abstract")},e.prototype.disconnect=function(){this.sendToServer(new r.WireDisconnectRequest)},e.prototype.disconnected=function(e){this._disconnectCallback=e},e.prototype.publish=function(e,t){var i=new r.WireChannelMessage;i.name=e,i.payload=new n.ByteArray(n.base64_encode(t)),this.sendToServer(i)},e.prototype.clientId=function(){return this._clientId},e.prototype.onReceiveText=function(e){this.bufString+=e;while(this.parseTextStream());},e.prototype.parseTextStream=function(){var e=this.bufString.indexOf(":");if(e!=-1){var t=this.bufString.substr(0,e),n=parseInt(t);if(this.bufString.length<n+1+e)return!1;var r=this.bufString.substr(e+1,n+1),i=r.charAt(r.length-1);i!=","&&console.error("TextProtocol decode exception, not terminated with comma");var s=r.substr(0,r.length-1);this.wireProtocol.dispatchNetstring(s);if(this.bufString.length>n+1+e+1){var o=this.bufString.substr(n+1+e+1);return this.bufString=o,!0}return this.bufString="",!1}return!1},e.prototype.onWireChannelJoin=function(e){var t=this.channelSubscribeMap[e.name],n=new f(this);n.name=e.name,n.setChannelPermissions(e.channelPermissions),this.channelMap[n.name]=n;if(!e.success)throw new Error("Unable to join channel, redirect this error please");t&&t(null,n)},e.prototype.onWireChannelLeave=function(e){delete this.channelListeners[e.name]},e.prototype.onWireChannelMessage=function(e){var t=this.channelMap[e.name];t.onWireChannelMessage(e)},e.prototype.onWireQueueMessage=function(e){var t=this.channelMap[e.name];t.onWireQueueMessage(e)},e.prototype.onWireRpcMessage=function(e){},e.prototype.onWireConnectFailure=function(e){var t=new a;t.clientId=null,t.success=!1,t.message=e.failureMessage,this._internalConnectionResult(t)},e.prototype.onWireConnectSuccess=function(e){this._clientId=e.clientId;var t=new a;t.clientId=e.clientId,t.success=!0,t.message=null,this._internalConnectionResult(t)},e.prototype.onWireChannelDataCreate=function(e){var t=this.channelMap[e.name];if(!t)throw new Error("Channel "+e.name+" does not exist.");t.onWireChannelDataCreate(e)},e.prototype.onWireChannelDataUpdate=function(e){var t=this.channelMap[e.name];if(!t)throw new Error("Channel "+e.name+" does not exist.");t.onWireChannelDataUpdate(e)},e.prototype.onWireChannelDataDelete=function(e){var t=this.channelMap[e.name];if(!t)throw new Error("Channel "+e.name+" does not exist.");t.onWireChannelDataDelete(e)},e.prototype.onWireChannelDataDel=function(e){console.log("implement me channeldatadel")},e.prototype.onWireChannelDataPut=function(e){console.log("implement me channeledataput")},e.prototype.onWireDisconnectSuccess=function(e){this.onDisconnect(!1),this._disconnectCallback&&this._disconnectCallback()},e.prototype.onWireChannelUnSubscribe=function(e){console.log("implement me unsubscrube")},e.prototype.onWireDisconnectRequest=function(e){},e.prototype.onWireConnectRequest=function(e){},e.prototype.onWireChannelSubscribe=function(e){console.log("implement me onchannelsubs")},e}();e.AbstractBigBangClient=c})(t.client||(t.client={}));var i=t.client});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("BrowserBigBangClient",["require","exports","./BigBangClient"],function(e,t,n){(function(e){var t=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.connect=function(e,t,r,i){var s=this;this.internalLogin(e,t,r,e,function(t){if(t.authenticated)s.internalConnect(e,t.clientKey,i);else{var r=new n.client.ConnectionResult;r.message=t.message,r.success=!1,i(r)}})},t.prototype.connectAnonymous=function(e,t){this.connect(e,null,null,t)},t.prototype.internalLogin=function(e,t,r,i,s){var o=e.split(":")[0],u=e.split(":")[1],a=this.wireProtocol.protocolHash,f="http://"+o+":"+u;!t&&!r?f+="/loginAnon?application="+i+"&wireprotocolhash="+a:f+="/login?username="+t+"&password="+r+"&application="+i+"&wireprotocolhash="+a;var l=this.createCORSRequest("GET",f);if(!l){alert("CORS not supported");return}l.onload=function(){var e=new n.client.LoginResult,t=JSON.parse(l.responseText);e.authenticated=t.authenticated,e.clientKey=t.clientKey,e.message=t.message,s(e)},l.onerror=function(){alert("Woops, there was an error making the request.")},l.send()},t.prototype.internalConnect=function(e,t,n){var r=this;this._internalConnectionResult=n,this._clientKey=t;var i="ws://"+e+"/";this.socket=new WebSocket(i),this.socket.onopen=function(e){setTimeout(function(){r.onConnect()},0)},this.socket.onmessage=function(e){var t=e.data.toString();r.onReceiveText(t)},this.socket.onclose=function(e){r._disconnectCallback&&r._disconnectCallback()},this.socket.onerror=function(e){console.error("WebSocket error: "+e)}},t.prototype.onDisconnect=function(e){e||(this.socket.onclose=null),this.socket.close()},t.prototype.sendToServer=function(e){var t=this.wireProtocol.wrapNetstring(e);this.socket?this.socket.send(t):console.error("Send while socket is null.")},t.prototype.createCORSRequest=function(e,t){var n=new XMLHttpRequest;if("withCredentials"in n)n.open(e,t,!0);else{if(typeof XDomainRequest!="undefined")throw new Error("FIX IE SUPPORT!");n=null}return n},t}(n.client.AbstractBigBangClient);e.BrowserBigBangClient=t})(t.client||(t.client={}));var r=t.client});